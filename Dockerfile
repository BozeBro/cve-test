FROM ubuntu:20.04
# set non-interactive shell
ENV DEBIAN_FRONTEND noninteractive

RUN apt update && \
  apt-get -y install \
  build-essential \
  cmake \
  openssl \
  libssl-dev \
  libz-dev \
  git

# Set working directory
WORKDIR /NuRaft

# Copy source
COPY . .
# Use the raft that is already installed
RUN ./prepare.sh && \
  rm -rf build && \
  mkdir build && \
  cd build && \
  cmake ../ && \
  make -j$(nproc)

